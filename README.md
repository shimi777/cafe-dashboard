# 📊 מערכת דוח פעולות ודוח מכירות יומי

## 🎯 מטרה הפרויקט

המערכת מאפשרת לבעל עסק להעלות קובץ HTML של דוח פעולות (מ-AccuPOS או מערכות POS דומות) וקבלת דוח מקיף של מכירות יומיות עם ניתוח עמוק של:
- 📈 מכירות לפי יום
- 📋 רשימה מלאה של טרנזקציות
- 🛒 סיכום פריטים ומוצרים מובילים
- 📊 גרפיקה וניתוח חזותי
- 📥 יצוא ל-Excel

## 🚀 איך להתחיל

### דרישות מערכת
- Python 3.8 ומעלה
- pip (מנהל חבילות Python)

### שלב 1: התקנת תלויות

```bash
pip install -r requirements.txt
```

### שלב 2: הרצה של האפליקציה

```bash
streamlit run app.py
```

האפליקציה תפתח בדפדפן שלך בכתובת:
```
http://localhost:8501
```

## 📁 מבנה הקבצים

```
.
├── app.py                    # אפליקציית Streamlit הראשית
├── html_to_excel.py          # מודול עיבוד ה-HTML ויצוא Excel
├── requirements.txt          # תלויות Python
└── README.md                 # קובץ זה
```

## 🔧 כיצד להשתמש

1. **הרץ את האפליקציה**
   ```bash
   streamlit run app.py
   ```

2. **העלה קובץ HTML**
   - בחץ על "בחר קובץ HTML" בתפריט הצד משמאל
   - בחר את קובץ דוח הפעולות שלך

3. **ראה את התוצאות**
   - הדוח יעובד אוטומטית
   - תראה מדדים עיקריים (סה"כ מכירות, מספר טרנזקציות וכו')
   - טבים שונים עבור דוחות מפורטים

4. **הורד דוח Excel**
   - לך לטאב "הורד"
   - לחץ על "הורד דוח מלא"
   - קובץ ה-Excel יוצא עם 3 גיליונות

## 📊 הטבים השונים

### 1️⃣ דוח יומי
- Table עם מכירות לכל יום
- מספר עסקאות יומי
- סה"כ כמות פריטים ביום

### 2️⃣ טרנזקציות מפורטות
- רשימה מלאה של כל עסקה
- סינון לפי תאריכים
- זמן העסקה ומספר פריטים

### 3️⃣ סיכום פריטים
- אילו מוצרים נמכרו הכי הרבה
- כמות בכל מוצר
- סה"כ הכנסה לפי מוצר

### 4️⃣ גרפיקה
- בר-צ'ארט של מכירות יומיות
- בר-צ'ארט של מספר עסקאות
- 15 הפריטים המובילים
- pie-chart של התפלגות מכירות
- סטטיסטיקה

### 5️⃣ הורד
- יצוא קובץ Excel עם כל הדוחות
- 3 גיליונות בקובץ

## 🔄 זרימת עיבוד הנתונים

```
HTML File (קובץ מקור)
        ↓
    parse_html_transactions() - חלץ נתונים
        ↓
    create_daily_summary() - סכם לפי יום
    create_detailed_transactions_df() - רשימה טרנזקציות
    create_items_summary_df() - סיכום פריטים
        ↓
    Display in Streamlit Dashboard
        ↓
    Export to Excel
```

## 📝 פרטי מודול html_to_excel.py

### parse_html_transactions(html_content)
- **קלט**: תוכן HTML
- **פלט**: רשימת dictionaries עם טרנזקציות
- **פרטים**: משכלל עם BeautifulSoup ומחלץ תאריך, זמן, פריטים וסך הכל

### create_daily_summary(transactions)
- **קלט**: רשימת טרנזקציות
- **פלט**: Pandas DataFrame עם מכירות יומיות
- **שדות**: תאריך, סה"כ מכירות, מספר עסקאות, כמות פריטים

### create_detailed_transactions_df(transactions)
- **קלט**: רשימת טרנזקציות
- **פלט**: DataFrame עם כל העסקאות בשורה אחת
- **שדות**: Order ID, Invoice, Date, Time, Item Count, Total

### create_items_summary_df(transactions)
- **קלט**: רשימת טרנזקציות
- **פלט**: DataFrame של סיכום פריטים
- **שדות**: שם הפריט, כמות, סך הכל, מספר עסקאות

### export_to_excel(transactions, filepath)
- **קלט**: טרנזקציות וגזרת קובץ
- **פלט**: קובץ Excel עם 3 גיליונות
- **גיליונות**: Daily Summary, Transactions, Items Summary

## 🎨 עיצוב ממשק המשתמש

- **שפה**: עברית (RTL)
- **צבעים**: כחול בהיר (#366092) לכותרות
- **טבלאות**: דינמיות וקלות לקריאה
- **גרפיקה**: Plotly עם צבעים משנים

## 🐛 פתרון בעיות

### בעיה: "ModuleNotFoundError: No module named 'streamlit'"
**פתרון**: הרץ את הפקודה:
```bash
pip install -r requirements.txt
```

### בעיה: "DecodeError בעברית"
**פתרון**: ודא שהקובץ HTML שמור בקידוד UTF-8

### בעיה: "לא נמצאו טרנזקציות"
**פתרון**: ודא שהקובץ הוא HTML מ-AccuPOS או מערכת דומה

## 📈 דוגמה לשימוש

1. קבלת קובץ HTML מה-POS
2. הרצת `streamlit run app.py`
3. העלאת הקובץ
4. צפייה בדוחות וגרפים
5. הורדת ה-Excel

## 📚 ספריות משומשות

- **streamlit**: ממשק משתמש אינטראקטיבי
- **pandas**: עיבוד נתונים
- **openpyxl**: יצוא Excel
- **plotly**: גרפיקה
- **beautifulsoup4**: parsing HTML

## 💡 טיפים

- ניתן להעלות קבצים HTML מרובים ברצף
- התוצאות מעודכנות בזמן אמת
- ניתן לסנן טרנזקציות לפי תאריכים
- כל הנתונים מופיעים בתרשימים

## 📞 תמיכה

אם אתה נתקל בבעיות:
1. בדוק שכל הספריות מותקנות
2. ודא שהקובץ HTML בפורמט נכון
3. בדוק שהנתונים בקובץ תקינים

---

**יוצר**: Data Science Guild  
**תאריך**: 2024  
**דרישות**: Python 3.8+
